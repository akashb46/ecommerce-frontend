document.addEventListener("DOMContentLoaded",async()=>{const t=document.getElementById("product-grid"),e=document.getElementById("cart-count");if(t)try{const e=await fetch("https://fakestoreapi.com/products"),o=await e.json();t.innerHTML="",o.forEach(e=>{const o=document.createElement("div");o.classList.add("product-card"),o.innerHTML=`\n        <a href="product.html?id=${e.id}" class="product-link">\n          <img \n            src="${e.image}" \n            alt="${e.title}" \n            loading="lazy" \n            width="200"\n          />\n          <h3>${e.title.slice(0,25)}...</h3>\n          <p class="price">‚Çπ${(83*e.price).toFixed(0)}</p>\n        </a>\n        <button class="btn add-to-cart">Add to Cart</button>\n      `,o.querySelector(".add-to-cart").addEventListener("click",t=>{t.preventDefault(),function(t){let e=JSON.parse(localStorage.getItem("cart"))||[];const o=e.find(e=>e.id===t.id);o?o.quantity+=1:e.push({...t,quantity:1});localStorage.setItem("cart",JSON.stringify(e)),n(),alert("‚úÖ Product added to cart!")}(e)}),t.appendChild(o)}),n()}catch(e){console.error("‚ö†Ô∏è Error loading products:",e),t.innerHTML="<p>‚ö†Ô∏è Failed to load products. Please try again later.</p>"}else console.error("‚ùå Product grid not found!");function n(){const t=(JSON.parse(localStorage.getItem("cart"))||[]).reduce((t,e)=>t+e.quantity,0);e&&(e.textContent=t)}}),document.addEventListener("DOMContentLoaded",async()=>{const t=document.getElementById("product-grid"),e=document.getElementById("cart-count");if(t)try{const e=await fetch("https://fakestoreapi.com/products"),o=await e.json();t.innerHTML="",o.forEach(e=>{const o=document.createElement("div");o.classList.add("product-card"),o.innerHTML=`\n        <a href="product.html?id=${e.id}" class="product-link">\n          <img \n            src="${e.image}" \n            alt="${e.title}" \n            loading="lazy" \n            width="200"\n          />\n          <h3>${e.title.slice(0,25)}...</h3>\n          <p class="price">‚Çπ${(83*e.price).toFixed(0)}</p>\n        </a>\n        <button class="btn add-to-cart">Add to Cart</button>\n      `,o.querySelector(".add-to-cart").addEventListener("click",t=>{t.preventDefault(),function(t){let e=JSON.parse(localStorage.getItem("cart"))||[];const o=e.find(e=>e.id===t.id);o?o.quantity+=1:e.push({...t,quantity:1}),localStorage.setItem("cart",JSON.stringify(e)),n(),alert("‚úÖ Product added to cart!")}(e)}),t.appendChild(o)}),n()}catch(e){console.error("‚ö†Ô∏è Error loading products:",e),t.innerHTML="<p>‚ö†Ô∏è Failed to load products. Please try again later.</p>"}else console.error("‚ùå Product grid not found!");function n(){const t=(JSON.parse(localStorage.getItem("cart"))||[]).reduce((t,e)=>t+e.quantity,0);e&&(e.textContent=t)}});import{initializeApp}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";import{getAuth,createUserWithEmailAndPassword,signInWithEmailAndPassword,updateProfile,onAuthStateChanged,signOut}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";const firebaseConfig={apiKey:"AIzaSyBcUDiB0gWP1NC-htGa7UXhzLMsb24AQzY",authDomain:"e-c0mmerce-18074.firebaseapp.com",projectId:"e-c0mmerce-18074",storageBucket:"e-c0mmerce-18074.firebasestorage.app",messagingSenderId:"721738222691",appId:"1:721738222691:web:6f2d580a610b3dd734fc56",measurementId:"G-LNF52WHGR4"},app=initializeApp(firebaseConfig),auth=getAuth(app);function getCart(){return JSON.parse(localStorage.getItem("cart"))||[]}function saveCart(t){localStorage.setItem("cart",JSON.stringify(t))}function addToCart(t){const e=getCart(),n=e.find(e=>e.id===t.id);n?n.quantity+=1:e.push({...t,quantity:1}),saveCart(e),updateCartCount(),alert("‚úÖ Product added to cart!")}function updateCartCount(){const t=document.getElementById("cart-count");if(!t)return;const e=getCart().reduce((t,e)=>t+e.quantity,0);t.textContent=e}function getCart(){return JSON.parse(localStorage.getItem("cart"))||[]}function saveCart(t){localStorage.setItem("cart",JSON.stringify(t))}function addToCart(t){const e=getCart(),n=e.find(e=>e.id===t.id);n?n.quantity+=1:e.push({...t,quantity:1}),saveCart(e),updateCartCount(),alert("‚úÖ Product added to cart!")}function updateCartCount(){const t=document.getElementById("cart-count");if(!t)return;const e=getCart().reduce((t,e)=>t+e.quantity,0);t.textContent=e}function saveAndRefresh(){localStorage.setItem("cart",JSON.stringify(cart)),displayCart()}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("logoutBtn"),e=document.getElementById("userName");onAuthStateChanged(auth,n=>{n?(console.log("User is logged in:",n.email),t&&(t.style.display="inline-block"),e&&(e.textContent=`Hello, ${n.displayName||n.email}`)):(t&&(t.style.display="none"),e&&(e.textContent=""),window.location.href.includes("login.html")||window.location.href.includes("signup.html")||(window.location.href="login.html"))}),t&&t.addEventListener("click",async()=>{try{await signOut(auth),alert("Logged out successfully!"),window.location.href="login.html"}catch(t){alert("Error logging out: "+t.message)}});const n=document.getElementById("loginForm");if(n){const t=document.getElementById("loginPassword"),e=document.querySelector("#loginForm .toggle-password");e&&e.addEventListener("click",()=>{"password"===t.type?(t.type="text",e.textContent="üôà"):(t.type="password",e.textContent="üëÅÔ∏è")}),n.addEventListener("submit",async e=>{e.preventDefault();const n=document.getElementById("loginEmail").value.trim(),o=t.value.trim();if(n&&o)try{await signInWithEmailAndPassword(auth,n,o),alert("Login successful!"),window.location.href="index.html"}catch(t){switch(t.code){case"auth/user-not-found":alert("No account found with this email.");break;case"auth/wrong-password":alert("Incorrect password. Try again.");break;default:alert(t.message)}}else alert("Please fill all fields!")})}const o=document.getElementById("signupForm");if(o){const t=document.getElementById("signupPassword"),e=document.getElementById("confirmPassword"),n=document.getElementById("strengthMsg"),a=document.querySelector("#signupForm .toggle-password");a&&a.addEventListener("click",()=>{"password"===t.type?(t.type="text",a.textContent="üôà"):(t.type="password",a.textContent="üëÅÔ∏è")}),t.addEventListener("input",()=>{const e=t.value;e.length<8?(n.textContent="Weak (min 8 chars)",n.style.color="red"):/[A-Z]/.test(e)&&/[a-z]/.test(e)&&/[0-9]/.test(e)?(n.textContent="Strong password",n.style.color="green"):(n.textContent="Medium (include uppercase, lowercase & number)",n.style.color="orange")}),o.addEventListener("submit",async n=>{n.preventDefault();const a=document.getElementById("signupName").value.trim(),i=document.getElementById("signupEmail").value.trim(),d=t.value.trim(),c=e.value.trim();if(a&&i&&d&&c)if(d===c)if(!(d.length<8)&&/[A-Z]/.test(d)&&/[a-z]/.test(d)&&/[0-9]/.test(d))try{const t=await createUserWithEmailAndPassword(auth,i,d);await updateProfile(t.user,{displayName:a}),alert("Signup successful! Please login."),o.reset(),window.location.href="login.html"}catch(t){switch(t.code){case"auth/email-already-in-use":alert("This email is already registered. Try logging in.");break;case"auth/invalid-email":alert("Invalid email format.");break;case"auth/weak-password":alert("Password is too weak. Use at least 8 chars, uppercase, lowercase & number.");break;default:alert(t.message)}}else alert("Password must be at least 8 chars and include uppercase, lowercase & number");else alert("Passwords do not match!");else alert("Please fill all fields!")})}}),document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("cart-container"),e=document.getElementById("cart-count"),n=document.getElementById("cart-total");let o=JSON.parse(localStorage.getItem("cart"))||[];function a(){if(t.innerHTML="",0===o.length)return t.innerHTML="<p>üõí Your cart is empty.</p>",n.textContent="0",void i();o.forEach((e,n)=>{const o=document.createElement("div");o.classList.add("cart-item"),o.innerHTML=`\n        <img src="${e.image}" alt="${e.title}" class="cart-img">\n        <div class="cart-details">\n          <h3>${e.title}</h3>\n          <p>Price: ‚Çπ${(83*e.price).toFixed(0)}</p>\n          <div class="quantity">\n            <button class="decrease" data-index="${n}">-</button>\n            <span>${e.quantity}</span>\n            <button class="increase" data-index="${n}">+</button>\n          </div>\n          <button class="remove-btn" data-index="${n}">üóëÔ∏è Remove</button>\n        </div>\n      `,t.appendChild(o)}),i(),function(){const t=o.reduce((t,e)=>t+e.quantity*(83*e.price),0);n.textContent=t.toFixed(0)}()}function i(){const t=o.reduce((t,e)=>t+e.quantity,0);e.textContent=t}t.addEventListener("click",t=>{const e=t.target.dataset.index;t.target.classList.contains("increase")?o[e].quantity+=1:t.target.classList.contains("decrease")?o[e].quantity=Math.max(1,o[e].quantity-1):t.target.classList.contains("remove-btn")&&o.splice(e,1),localStorage.setItem("cart",JSON.stringify(o)),a()}),a()}),document.addEventListener("DOMContentLoaded",()=>{updateCartCount()}),document.addEventListener("DOMContentLoaded",updateCartCount),cartContainer.addEventListener("click",t=>{if(t.target.classList.contains("increase")){const e=t.target.dataset.index;cart[e].quantity+=1,saveAndRefresh()}if(t.target.classList.contains("decrease")){const e=t.target.dataset.index;cart[e].quantity>1?cart[e].quantity-=1:cart.splice(e,1),saveAndRefresh()}if(t.target.classList.contains("remove-btn")){const e=t.target.dataset.index;cart.splice(e,1),saveAndRefresh()}}),checkoutBtn.addEventListener("click",()=>{cart.length>0&&(window.location.href="checkout.html")}),displayCart(),document.addEventListener("DOMContentLoaded",()=>{document.querySelector(".checkout-btn")}),checkoutBtn.addEventListener("click",()=>{cart.length>0&&(window.location.href="checkout.html")}),document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("order-items"),e=document.getElementById("order-total"),n=document.getElementById("checkout-form");let o=JSON.parse(localStorage.getItem("cart"))||[];n.addEventListener("submit",t=>{t.preventDefault();const e=document.getElementById("name").value.trim(),n=document.getElementById("email").value.trim(),o=document.getElementById("address").value.trim(),a=document.getElementById("payment").value;e&&n&&o&&a?(alert(`‚úÖ Thank you, ${e}! Your order has been placed successfully.`),localStorage.removeItem("cart"),window.location.href="index.html"):alert("Please fill out all fields.")}),function(){if(t.innerHTML="",0===o.length)return t.innerHTML="<p>Your cart is empty.</p>",e.textContent="0",void(n.querySelector(".confirm-btn").disabled=!0);let a=0;o.forEach(e=>{const n=document.createElement("div");n.classList.add("order-item"),n.innerHTML=`\n        <p><strong>${e.title}</strong> (${e.quantity} √ó ‚Çπ${(83*e.price).toFixed(0)})</p>\n      `,t.appendChild(n),a+=e.quantity*(83*e.price)}),e.textContent=a.toFixed(0)}()}),document.addEventListener("DOMContentLoaded",async()=>{const t=new URLSearchParams(window.location.search),e=parseInt(t.get("id")),n=document.getElementById("product-container"),o=document.getElementById("related-products-grid");try{const i=await fetch("https://fakestoreapi.com/products");if(!i.ok)throw new Error("Failed to fetch products");const d=await i.json(),c=d.find(t=>t.id===e);if(!c)return void(n.innerHTML="<p>Product not found.</p>");n.innerHTML=`\n      <div class="product-images">\n        <img id="productImage" src="${c.image}" alt="${c.title}">\n        <div id="zoomLens"></div>\n      </div>\n      <div class="product-info">\n        <h2 id="productTitle">${c.title}</h2>\n        <p class="price" id="productPrice">‚Çπ${(83*c.price).toFixed(0)}</p>\n        <p class="description" id="productDescription">${c.description}</p>\n\n        <div class="product-variations">\n          <label for="size">Size:</label>\n          <select id="size">\n            <option value="S">S</option>\n            <option value="M" selected>M</option>\n            <option value="L">L</option>\n            <option value="XL">XL</option>\n          </select>\n\n          <label for="color">Color:</label>\n          <select id="color">\n            <option value="Red">Red</option>\n            <option value="Blue" selected>Blue</option>\n            <option value="Black">Black</option>\n          </select>\n        </div>\n\n        <div class="quantity-selector">\n          <button id="decrease">‚àí</button>\n          <span id="quantity">1</span>\n          <button id="increase">+</button>\n        </div>\n        <p>Total: ‚Çπ<span id="total-price">${(83*c.price).toFixed(0)}</span></p>\n\n        <button class="btn" id="add-to-cart">üõí Add to Cart</button>\n      </div>\n    `;let s=1;const r=83*c.price,l=document.getElementById("quantity"),u=document.getElementById("total-price");function a(){u.textContent=(r*s).toFixed(0)}document.getElementById("increase").addEventListener("click",()=>{s<10&&s++,l.textContent=s,a()}),document.getElementById("decrease").addEventListener("click",()=>{s>1&&s--,l.textContent=s,a()}),a();const m=document.getElementById("size"),p=document.getElementById("color");document.getElementById("add-to-cart").addEventListener("click",()=>{let t=JSON.parse(localStorage.getItem("cart"))||[];const e=m.value,n=p.value,o=t.find(t=>t.id===c.id&&t.size===e&&t.color===n);o?o.quantity+=s:t.push({...c,quantity:s,size:e,color:n}),localStorage.setItem("cart",JSON.stringify(t)),alert("‚úÖ Product added to cart!")});const g=document.getElementById("productImage"),f=document.getElementById("zoomLens"),h=document.getElementById("zoomResult");if(g){g.addEventListener("mousemove",function(t){const e=g.getBoundingClientRect();let n=t.clientX-e.left-f.offsetWidth/2,o=t.clientY-e.top-f.offsetHeight/2;n<0&&(n=0);o<0&&(o=0);n>g.width-f.offsetWidth&&(n=g.width-f.offsetWidth);o>g.height-f.offsetHeight&&(o=g.height-f.offsetHeight);f.style.left=n+"px",f.style.top=o+"px";const a=h.offsetWidth/f.offsetWidth,i=h.offsetHeight/f.offsetHeight;h.style.backgroundImage=`url(${g.src})`,h.style.backgroundSize=`${g.width*a}px ${g.height*i}px`,h.style.backgroundPosition=`-${n*a}px -${o*i}px`}),g.addEventListener("mouseenter",()=>{f.style.display="block",h.style.display="block"}),g.addEventListener("mouseleave",()=>{f.style.display="none",h.style.display="none"})}const y=d.filter(t=>t.id!==e).slice(0,4);o.innerHTML="",y.forEach(t=>{const e=document.createElement("div");e.classList.add("product-card"),e.innerHTML=`\n        <img src="${t.image}" alt="${t.title}">\n        <h4>${t.title.length>25?t.title.slice(0,25)+"...":t.title}</h4>\n        <p>‚Çπ${(83*t.price).toFixed(0)}</p>\n        <a href="product.html?id=${t.id}" class="btn">View Details</a>\n      `,o.appendChild(e)})}catch(v){console.error(v),n.innerHTML="<p>‚ö†Ô∏è Failed to load product details.</p>"}});const img=document.getElementById("productImage"),zoomLens=document.getElementById("zoomLens"),zoomResult=document.getElementById("zoomResult");if(img&&zoomLens&&zoomResult)if("ontouchstart"in window)zoomLens.style.display="none",zoomResult.style.display="none";else{function moveLens(t){const e=img.getBoundingClientRect();let n=t.clientX-e.left-zoomLens.offsetWidth/2,o=t.clientY-e.top-zoomLens.offsetHeight/2;n<0&&(n=0),o<0&&(o=0),n>img.width-zoomLens.offsetWidth&&(n=img.width-zoomLens.offsetWidth),o>img.height-zoomLens.offsetHeight&&(o=img.height-zoomLens.offsetHeight),zoomLens.style.left=n+"px",zoomLens.style.top=o+"px";const a=zoomResult.offsetWidth/zoomLens.offsetWidth,i=zoomResult.offsetHeight/zoomLens.offsetHeight;zoomResult.style.backgroundImage=`url(${img.src})`,zoomResult.style.backgroundSize=`${img.width*a}px ${img.height*i}px`,zoomResult.style.backgroundPosition=`-${n*a}px -${o*i}px`}img.addEventListener("mousemove",moveLens),img.addEventListener("mouseenter",()=>{zoomLens.style.display="block",zoomResult.style.display="block"}),img.addEventListener("mouseleave",()=>{zoomLens.style.display="none",zoomResult.style.display="none"})}function updateCartCount(){const t=(JSON.parse(localStorage.getItem("cart"))||[]).reduce((t,e)=>t+e.quantity,0),e=document.getElementById("cart-count");e&&(e.textContent=t)}document.getElementById("add-to-cart").addEventListener("click",()=>{let t=JSON.parse(localStorage.getItem("cart"))||[];const e=sizeSelect.value,n=colorSelect.value,o=t.find(t=>t.id===product.id&&t.size===e&&t.color===n);o?o.quantity+=quantity:t.push({...product,quantity:quantity,size:e,color:n}),localStorage.setItem("cart",JSON.stringify(t)),updateCartCount(),alert("‚úÖ Product added to cart!")}),updateCartCount(),document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("product-container"),e=document.getElementById("cart-count"),n=new URLSearchParams(window.location.search).get("id");function o(){const t=(JSON.parse(localStorage.getItem("cart"))||[]).reduce((t,e)=>t+e.quantity,0);e.textContent=t}n?(fetch(`https://fakestoreapi.com/products/${n}`).then(t=>t.json()).then(e=>function(e){t.innerHTML=`\n      <div class="product-images">\n        <img src="${e.image}" alt="${e.title}">\n      </div>\n      <div class="product-info">\n        <h2>${e.title}</h2>\n        <p class="price">‚Çπ${(83*e.price).toFixed(0)}</p>\n        <p class="description">${e.description}</p>\n        <button id="add-to-cart" class="btn">üõí Add to Cart</button>\n      </div>\n    `,document.getElementById("add-to-cart").addEventListener("click",()=>{!function(t){let e=JSON.parse(localStorage.getItem("cart"))||[];const n=e.find(e=>e.id===t.id);n?n.quantity+=1:e.push({...t,quantity:1});localStorage.setItem("cart",JSON.stringify(e)),o(),alert("‚úÖ Product added to cart!")}(e)})}(e)).catch(e=>{console.error(e),t.innerHTML="<p>‚ö†Ô∏è Failed to load product details.</p>"}),o()):t.innerHTML="<p>‚ö†Ô∏è No product selected.</p>"}),document.addEventListener("DOMContentLoaded",async()=>{const t=document.getElementById("products-grid");if(t)try{const e=await fetch("https://fakestoreapi.com/products");(await e.json()).forEach(e=>{const n=document.createElement("div");n.classList.add("product-card");const o=document.createElement("picture"),a=document.createElement("source");a.type="image/webp",a.srcset=`\n        images/${e.id}-small.webp 480w,\n        images/${e.id}-medium.webp 768w,\n        images/${e.id}-large.webp 1200w\n      `,a.sizes="(max-width: 480px) 480px, (max-width: 768px) 768px, 1200px";const i=document.createElement("img");i.src=`images/${e.id}-medium.webp`,i.alt=e.title,i.loading="lazy",i.dataset.src=`images/${e.id}-medium.webp`,o.appendChild(a),o.appendChild(i);const d=document.createElement("h3");d.textContent=e.title;const c=document.createElement("p");c.textContent=`$${e.price}`,n.appendChild(o),n.appendChild(d),n.appendChild(c),t.appendChild(n)});const n=document.querySelectorAll("img[data-src]"),o=new IntersectionObserver((t,e)=>{t.forEach(t=>{if(t.isIntersecting){const n=t.target;n.src=n.dataset.src,n.removeAttribute("data-src"),e.unobserve(n)}})});n.forEach(t=>o.observe(t))}catch(e){console.error("Error loading products:",e),t.innerHTML="<p>Failed to load products. Please try again later.</p>"}});